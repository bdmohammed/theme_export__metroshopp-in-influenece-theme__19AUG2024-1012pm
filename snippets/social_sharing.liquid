{% comment %}
  Component: Social Media Links
  Description: Displays share/follow buttons for social platforms with dynamic icon rendering
  Features:
  - Two modes: Share current content or Follow store's social profiles
  - Configurable via theme settings
  - Responsive grid layout with spacing control
  - Accessibility-friendly with title attributes
  - Tooltip support
  - Secure link attributes (noopener/noreferrer)
  Parameters:
  - follow_social: Boolean to toggle share/follow mode
  - class_tooltip: Tooltip position class (default: 'top')
  - style: Styling variant (socials-style-{value})
  - size: Icon size variant (socials-size-{value})
  - use_color_set: Color scheme control (setts-color-{value})
  - space_h_item/space_v_item: Horizontal/vertical spacing
  - space_h_item_mb/space_v_item_mb: Mobile spacing
  Dependencies:
  - icon_socials snippet (for SVG icons)
  - Theme settings for social URLs and sharing preferences
  Usage:
  Sharing mode:
    {% render 'social-media-links',
      follow_social: false,
      style: 'circle',
      size: 'md'
    %}
  Follow mode:
    {% render 'social-media-links',
      follow_social: true,
      class_tooltip: 'right'
    %}
  Notes:
  - Add/remove platforms via theme settings
  - Sharing mode auto-detects product/article context
  - Icons use 'icon_socials' snippet for consistent rendering
  - Includes security best practices for external links
  - Email/WhatsApp sharing uses platform-specific URI schemes
  - Maintains referrer policy with rel attributes
  - Responsive spacing uses Shopify's grid system
{% endcomment %}

{%- liquid
  # Initialize variables
  assign social_icons = false
  assign target = '_blank'

  # Set tooltip class if not provided
  unless class_tooltip
    assign class_tooltip = 'top'
  endunless

  # Handle SHARE buttons (when follow_social is false or not provided)
  unless follow_social
    assign share_perma_link = product.url | default: article.url | default: page.url | escape
    assign share_perma_link_2 = shop.url | append: share_perma_link | escape
    assign perma_link_url = share_perma_link | default: share_perma_link_2

    # Set share title
    unless share_title
      assign share_title = product.title | default: article.title | default: page.title | default: shop.name
    endunless

    # Set share image
    assign perma_title = share_title | url_param_escape
    unless share_image
      assign share_image = product.featured_image | default: article.image | default: settings.share_image | default: page_image | default: settings.logo
    endunless
    assign perma_image = share_image | image_url: '1024x1024'
    # Handle FOLLOW buttons (when follow_social is true)
  else
    # Check if any social media links are configured in settings
    if settings.social_tiktok_link != blank or
      settings .social_soundcloud_link != blank or
      settings .social_behance_link != blank or
      settings .social_youtube_link != blank or
      settings .social_tumblr_link != blank or
      settings .social_pinterest_link != blank or
      settings .social_linkedin_link != blank or
      settings .social_dribbble_link != blank or
      settings .social_instagram_link != blank or
      settings .social_twitter_link != blank or
      settings .social_facebook_link != blank
      assign social_icons = true
    endif
  endunless

  # Prepare arrays for social follow links (used only when follow_social is true)
  if social_icons
    # Setting keys for social links
    assign socials = 'social_facebook_link social_twitter_link social_instagram_link social_dribbble_link social_linkedin_link social_pinterest_link social_tumblr_link social_snapchat_link social_youtube_link social_vimeo_link social_behance_link social_soundcloud_link social_tiktok_link' | split: ' '

    # Icon names corresponding to each social platform
    assign socials_icon = 'facebook twitter instagram dribbble linkedin pinterest tumblr snapchat youtube vimeo behance soundcloud tiktok' | split: ' '

    # Translation keys for social platform titles
    assign socials_txt = 'socials.follow_fb;socials.follow_tw;socials.follow_it;socials.follow_dr;socials.follow_ld;socials.follow_pr;socials.follow_tu;socials.follow_sp;socials.follow_yt;socials.follow_vm;socials.follow_bh;socials.follow_sc;socials.follow_tt' | split: ';'
  endif
-%}

<div class="socials socials-style-{{style}} socials-size-{{size}} setts-color-{{use_color_set}} row ts-gx-md-{{space_h_item}} ts-gy-md-{{space_v_item}} ts-gx-{{space_h_item_mb}} ts-gy-{{space_v_item_mb}}">
  {%- unless follow_social -%}
    {%- comment -%} SHARE BUTTONS SECTION {%- endcomment -%}
    {%- if settings.share_facebook -%}
      <div class="col-item col-auto">
        <a
          title="{{ 'socials.share_fb' | t | escape }}"
          data-no-instant
          rel="noopener noreferrer nofollow"
          href="https://www.facebook.com/sharer/sharer.php?u={{ perma_link_url }}"
          target="{{target}}"
          class="facebook"
          data-tooltip="{{class_tooltip}}"
        >
          {%- render 'icon_socials', icon_name: 'facebook' -%}
        </a>
      </div>
    {%- endif -%}
    {%- if settings.share_twitter -%}
      <div class="col-item col-auto">
        <a
          title="{{ 'socials.share_tw' | t | escape }}"
          data-no-instant
          rel="noopener noreferrer nofollow"
          href="http://twitter.com/share?text={{ perma_title }}&amp;url={{ perma_link_url }}"
          target="{{target}}"
          class="twitter"
          data-tooltip="{{class_tooltip}}"
        >
          {%- render 'icon_socials', icon_name: 'twitter' -%}
        </a>
      </div>
    {%- endif -%}

    {%- comment -%} Image-based sharing platforms (Pinterest & Instagram) {%- endcomment -%}
    {%- if perma_image != blank -%}
      {%- if settings.share_pinterest -%}
        <div class="col-item col-auto">
          <a
            title="{{ 'socials.share_pr' | t | escape }}"
            data-no-instant
            rel="noopener noreferrer nofollow"
            href="http://pinterest.com/pin/create/button/?url={{ perma_link_url }}&amp;media=http:{{perma_image}}&amp;description={{ perma_title }}"
            target="{{target}}"
            class="pinterest"
            data-tooltip="{{class_tooltip}}"
          >
            {%- render 'icon_socials', icon_name: 'pinterest' -%}
          </a>
        </div>
      {%- endif -%}

      {%- if settings.share_tumblr -%}
        <div class="col-item col-auto">
          <a
            title="{{ 'socials.share_tu' | t | escape }}"
            data-no-instant
            rel="noopener noreferrer nofollow"
            data-content="http:{{perma_image}}"
            href="{{ settings.social_instagram_link | escape }}"
            target="{{target}}"
            class="instagram"
            data-tooltip="{{class_tooltip}}"
          >
            {%- render 'icon_socials', icon_name: 'instagram' -%}
          </a>
        </div>
      {%- endif -%}
    {%- endif -%}
    {%- if settings.share_telegram -%}
      <div class="col-item col-auto">
        <a
          title="{{ 'socials.share_tl' | t | escape }}"
          data-no-instant
          rel="nofollow"
          target="{{target}}"
          class="telegram"
          href="https://telegram.me/share/url?url={{ perma_link_url }}"
          data-tooltip="{{class_tooltip}}"
        >
          {%- render 'icon_socials', icon_name: 'telegram' -%}
        </a>
      </div>
    {%- endif -%}
    {%- if settings.share_email -%}
      <div class="col-item col-auto">
        <a
          title="{{ 'socials.share_em' | t | escape }}"
          data-no-instant
          rel="noopener noreferrer nofollow"
          href="mailto:?subject={{ perma_title }}&amp;body={{ perma_link_url }}"
          target="{{target}}"
          class="email"
          data-tooltip="{{class_tooltip}}"
        >
          {%- render 'icon_socials', icon_name: 'mail' -%}
        </a>
      </div>
    {%- endif -%}
    {%- if settings.share_whatsapp -%}
      <div class="col-item col-auto">
        <a
          title="{{ 'socials.share_wa' | t | escape }}"
          data-no-instant
          rel="nofollow"
          target="{{target}}"
          class="whatsapp"
          href="https://wa.me/?text={{ perma_title }}&#x20;{{ perma_link_url }}"
          data-tooltip="{{class_tooltip}}"
        >
          {%- render 'icon_socials', icon_name: 'whatsapp' -%}
        </a>
      </div>
    {%- endif -%}
  {%- else -%}
    {%- if social_icons -%}
      {%- for social_link in socials -%}
        {% if settings[social_link] != blank -%}
          <div class="col-item col-auto">
            <a
              title="{{socials_txt[forloop.index0] | t | escape }}"
              data-no-instant
              rel="noopener noreferrer nofollow"
              href="{{ settings[social_link] | escape }}"
              target="{{target}}"
              class="{{socials_icon[forloop.index0] }}"
              data-tooltip="{{class_tooltip}}"
            >
              {%- render 'icon_socials', icon_name: socials_icon[forloop.index0] -%}
            </a>
          </div>
        {%- endif -%}
      {% endfor -%}
    {%- endif -%}
  {%- endunless -%}
</div>
